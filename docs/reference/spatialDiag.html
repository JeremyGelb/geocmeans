<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial diagnostic — spatialDiag • geocmeans</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Spatial diagnostic — spatialDiag" />
<meta property="og:description" content="Utility function to facilitate the spatial diagnostic of a classification
Calculate the following indicators: Moran I index (spdep::moranI) for each
column of the membership matrix, Join count test (spdep::joincount.multi) for
the most likely groups of each datapoint, Spatial consistency index (see
function spConsistency) and the Elsa statistic (see function calcElsa). Note
that if the FCMres object given was constructed with rasters, the joincount
statistic is not calculated and no p-values are provided for the Moran I
indices." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geocmeans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/adjustinconsistency.html">An adjusted spatial inconsistency index</a>
    </li>
    <li>
      <a href="../articles/FCMres.html">Creating a FCMres object</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Spatial Fuzzy CMean with R</a>
    </li>
    <li>
      <a href="../articles/rasters.html">Fuzzy clustering with rasters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JeremyGelb/geocmeans/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial diagnostic</h1>
    <small class="dont-index">Source: <a href='https://github.com/JeremyGelb/geocmeans/blob/master/R/clustering_evaluation.R'><code>R/clustering_evaluation.R</code></a></small>
    <div class="hidden name"><code>spatialDiag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Utility function to facilitate the spatial diagnostic of a classification</p>
<p>Calculate the following indicators: Moran I index (spdep::moranI) for each
column of the membership matrix, Join count test (spdep::joincount.multi) for
the most likely groups of each datapoint, Spatial consistency index (see
function spConsistency) and the Elsa statistic (see function calcElsa). Note
that if the FCMres object given was constructed with rasters, the joincount
statistic is not calculated and no p-values are provided for the Moran I
indices.</p>
    </div>

    <pre class="usage"><span class='fu'>spatialDiag</span><span class='op'>(</span>
  <span class='va'>object</span>,
  nblistw <span class='op'>=</span> <span class='cn'>NULL</span>,
  window <span class='op'>=</span> <span class='cn'>NULL</span>,
  undecided <span class='op'>=</span> <span class='cn'>NULL</span>,
  matdist <span class='op'>=</span> <span class='cn'>NULL</span>,
  nrep <span class='op'>=</span> <span class='fl'>50</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A FCMres object, typically obtained from functions CMeans,
GCMeans, SFCMeans, SGFCMeans. Can also be a simple membership matrix.</p></td>
    </tr>
    <tr>
      <th>nblistw</th>
      <td><p>A list.w object describing the neighbours typically produced
by the spdep package. Required if data is a dataframe, see the parameter window
if you use a list of rasters as input. Can also be NULL if object is a FCMres object.</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>If rasters were used for the classification, the window must be
specified instead of a list.w object. Can also be NULL if object is a FCMres object.</p></td>
    </tr>
    <tr>
      <th>undecided</th>
      <td><p>A float giving the threslhod to detect undecided observations. An
observation is undecided if its maximum membership value is bellow this float. If
null, no observations are undecided.</p></td>
    </tr>
    <tr>
      <th>matdist</th>
      <td><p>A matrix representing the dissimilarity between the clusters. The matrix must
be squared and the diagonal must be filled with zeros.</p></td>
    </tr>
    <tr>
      <th>nrep</th>
      <td><p>An integer indicating the number of permutation to do to simulate
the random distribution of the spatial inconsistency</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A named list with :</p><ul>
<li><p>MoranValues : the moran I values for each column of the membership
         matrix (spdep::MoranI)</p></li>
<li><p>JoinCounts : the result of the join count test calculated with
         the most likely group for each datapoint (spdep::joincount.multi)</p></li>
<li><p>SpConsist : the mean value of the spatial consistency index
        (the lower, the better, see ?spConsistency for details)</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>LyonIris</span><span class='op'>)</span>
<span class='va'>AnalysisFields</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lden"</span>,<span class='st'>"NO2"</span>,<span class='st'>"PM25"</span>,<span class='st'>"VegHautPrt"</span>,<span class='st'>"Pct0_14"</span>,<span class='st'>"Pct_65"</span>,<span class='st'>"Pct_Img"</span>,
<span class='st'>"TxChom1564"</span>,<span class='st'>"Pct_brevet"</span>,<span class='st'>"NivVieMed"</span><span class='op'>)</span>
<span class='va'>dataset</span> <span class='op'>&lt;-</span> <span class='fu'>sf</span><span class='fu'>::</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_geometry.html'>st_drop_geometry</a></span><span class='op'>(</span><span class='va'>LyonIris</span><span class='op'>[</span><span class='va'>AnalysisFields</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>queen</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/poly2nb.html'>poly2nb</a></span><span class='op'>(</span><span class='va'>LyonIris</span>,queen<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>Wqueen</span> <span class='op'>&lt;-</span> <span class='fu'>spdep</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>queen</span>,style<span class='op'>=</span><span class='st'>"W"</span><span class='op'>)</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'><a href='SFCMeans.html'>SFCMeans</a></span><span class='op'>(</span><span class='va'>dataset</span>, <span class='va'>Wqueen</span>,k <span class='op'>=</span> <span class='fl'>5</span>, m <span class='op'>=</span> <span class='fl'>1.5</span>, alpha <span class='op'>=</span> <span class='fl'>1.5</span>, standardize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>spatialDiag</span><span class='op'>(</span><span class='va'>result</span>, undecided<span class='op'>=</span><span class='fl'>0.45</span>, nrep<span class='op'>=</span><span class='fl'>30</span><span class='op'>)</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jeremy Gelb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


