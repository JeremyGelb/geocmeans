<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Optimizing Parameters â€¢ geocmeans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Optimizing Parameters">
<meta property="og:description" content="geocmeans">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">geocmeans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/adjustinconsistency.html">An adjusted spatial inconsistency index</a>
    </li>
    <li>
      <a href="../../articles/FCMres.html">Creating a FCMres object</a>
    </li>
    <li>
      <a href="../../articles/introduction.html">Spatial Fuzzy CMean with R</a>
    </li>
    <li>
      <a href="../../articles/rasters.html">Fuzzy clustering with rasters</a>
    </li>
    <li>
      <a href="../../articles/web_vignettes/advanced_examples.html">Advanced examples</a>
    </li>
    <li>
      <a href="../../articles/web_vignettes/optimizing_parameters.html">Optimizing Parameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JeremyGelb/geocmeans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="optimizing_parameters_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="optimizing_parameters_files/plotly-binding-4.10.2/plotly.js"></script><script src="optimizing_parameters_files/typedarray-0.1/typedarray.min.js"></script><link href="optimizing_parameters_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="optimizing_parameters_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="optimizing_parameters_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="optimizing_parameters_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Optimizing Parameters</h1>
                        <h4 data-toc-skip class="author">Jeremy
Gelb</h4>
            
            <h4 data-toc-skip class="date">14/12/2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JeremyGelb/geocmeans/blob/HEAD/vignettes/web_vignettes/optimizing_parameters.Rmd" class="external-link"><code>vignettes/web_vignettes/optimizing_parameters.Rmd</code></a></small>
      <div class="hidden name"><code>optimizing_parameters.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we will illustrate how one can use a genetic
algorithm to select hyperparameters for the spatial fuzzy clustering
algorithm.</p>
<p>The proposed approach in the package (<code>select_parameters</code>)
can be seen as a grid search method. It can be calculation intensive
when the number of parameters increase. In the case of the SGFCM, three
numeric parameters (<code>alpha</code>, <code>beta</code>, and
<code>m</code>) must be selected by the user. If one decide to add a
noise cluster, with also have to select <code>delta</code>.</p>
<p>If the number of clusters (<code>k</code>) is already selected, we
can use a genetic algorithm to optimize the choice of these
hyperparameters. In the case of a spatial clustering, we have two
objective functions to optimize: the spatial consistency and the
clusters validity.</p>
<p>We show here how it can be done with the package <code>nsga2R</code>.
This method also illustrate how the two objectives are concurrent and no
solution can fulfill both of them, but some solutions provide
interesting compromises. For more information about the multiobjective
genetic algorithm, you could check this <a href="https://rpubs.com/Argaadya/moea" class="external-link">link</a>.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>We start by loading the data and create a fitness function that will
be used by the genetic algorithm.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JeremyGelb/geocmeans" class="external-link">geocmeans</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap" class="external-link">tmap</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">nsga2R</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AnalysisFields</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lden"</span>,<span class="st">"NO2"</span>,<span class="st">"PM25"</span>,<span class="st">"VegHautPrt"</span>,<span class="st">"Pct0_14"</span>,</span>
<span>                   <span class="st">"Pct_65"</span>,<span class="st">"Pct_Img"</span>,<span class="st">"TxChom1564"</span>,<span class="st">"Pct_brevet"</span>,<span class="st">"NivVieMed"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="va">AnalysisFields</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the spatial weight matrix</span></span>
<span><span class="va">Neighbours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="va">LyonIris</span>,queen <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">WMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">Neighbours</span>,style<span class="op">=</span><span class="st">"W"</span>,zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We try to otpimize a SGFCM with 3 parameters :</p>
<ul>
<li>
<code>m</code>, the fuzzyness index (limited between 1 and 2)</li>
<li>
<code>alpha</code>, the weight given to the spatially lagged dataset
(limited between 0 and 5)</li>
<li>
<code>beta</code>, control classification crispness (between 0 and
0.99)</li>
</ul>
<p>We want to obtain a classification with a good quality (maximizing
the silhouette index) and a good spatial consistency (minimizing spatial
inconsistency). We also add the explained inertia as a third objective
function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fintess_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span>  <span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/SGFCMeans.html">SGFCMeans</a></span><span class="op">(</span><span class="va">Data</span>,</span>
<span>                         <span class="va">WMat</span>, </span>
<span>                         k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                         m <span class="op">=</span> <span class="va">m</span>,</span>
<span>                         alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>                         beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>                         robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                         standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                         maxiter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                         seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>                         init <span class="op">=</span> <span class="st">"kpp"</span><span class="op">)</span></span>
<span>  <span class="va">sil</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcSilhouetteIdx.html">calcSilhouetteIdx</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">Data</span>, </span>
<span>                           belongings <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">Belongings</span><span class="op">)</span></span>
<span>  <span class="va">inertia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcexplainedInertia.html">calcexplainedInertia</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">Data</span>, </span>
<span>                         belongmatrix <span class="op">=</span> <span class="va">clustering</span><span class="op">$</span><span class="va">Belongings</span><span class="op">)</span></span>
<span>  <span class="va">space_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/spConsistency.html">spConsistency</a></span><span class="op">(</span><span class="va">clustering</span>, nblistw <span class="op">=</span> <span class="va">WMat</span>, nrep <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">sil</span>,  <span class="va">space_idx</span><span class="op">$</span><span class="va">sum_diff</span>, <span class="op">-</span><span class="va">inertia</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-genetic-algorithm">Running the genetic algorithm<a class="anchor" aria-label="anchor" href="#running-the-genetic-algorithm"></a>
</h2>
<p>This can be a long step, but this function could be easily
paralellized.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nsga2R/man/nsga2R.html" class="external-link">nsga2R</a></span><span class="op">(</span><span class="va">fintess_func</span>,</span>
<span>                  varNo <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  objDim <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  lowerBounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                  upperBounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">0.99</span><span class="op">)</span>,</span>
<span>                  popSize <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                  generations <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  cprob <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>                  mprob <span class="op">=</span> <span class="fl">0.2</span></span>
<span>                  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyzing-the-results">Analyzing the results<a class="anchor" aria-label="anchor" href="#analyzing-the-results"></a>
</h2>
<p>We combine the scores obtained in one dataframe and then we can start
the analysis of the proposed solutions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_params</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"alpha"</span>,<span class="st">"beta"</span><span class="op">)</span></span>
<span><span class="va">df_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">objectives</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"silhouette"</span>,<span class="st">"space"</span>,<span class="st">"inertia"</span><span class="op">)</span></span>
<span><span class="va">df_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df_params</span>, <span class="va">df_scores</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_tot</span><span class="op">$</span><span class="va">silhouette</span> <span class="op">&lt;-</span> <span class="va">df_tot</span><span class="op">$</span><span class="va">silhouette</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">df_tot</span><span class="op">$</span><span class="va">inertia</span> <span class="op">&lt;-</span> <span class="va">df_tot</span><span class="op">$</span><span class="va">inertia</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">df_tot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">df_tot</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">silhouette</span>, y <span class="op">=</span> <span class="va">space</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">silhouette</span>, y <span class="op">=</span> <span class="va">inertia</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">inertia</span>, y <span class="op">=</span> <span class="va">space</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>,<span class="va">p3</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="optimizing_parameters_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>It seems that the algorithm is able to find a set of solutions that
minimize simultaneously the silhouette index and the spatial
inconsistency, but finding a compromise between the explained inertia
and the spatial consistency is difficult.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">beta</span>, color <span class="op">=</span> <span class="va">space</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">m</span>, color <span class="op">=</span> <span class="va">space</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">beta</span>, color <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_tot</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha</span>, y <span class="op">=</span> <span class="va">m</span>, color <span class="op">=</span> <span class="va">silhouette</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>,<span class="va">p2</span>,<span class="va">p3</span>,<span class="va">p4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="optimizing_parameters_files/figure-html/unnamed-chunk-6-1.png" width="100%"><code>alpha</code> is positively correlated with a lower value of
spatial inconsistency, but is also negatively correlated with the
silhouette index. <code>m</code> is positively associated with the
silhouette index and the spatial consistency.</p>
<p>The following 3D plot clearly demonstrates the Pareto front: the set
of dominant solutions. It forms a curved plane.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html" class="external-link">plot_ly</a></span><span class="op">(</span><span class="va">df_tot</span>, x <span class="op">=</span> <span class="op">~</span><span class="va">silhouette</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">inertia</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">space</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">add_markers</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_trace.html" class="external-link">add_trace</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"mesh3d"</span>, opacity <span class="op">=</span> <span class="fl">0.5</span>, facecolor <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">layout</span><span class="op">(</span>scene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'silhouette'</span><span class="op">)</span>,</span>
<span>                     yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'explained inertia'</span><span class="op">)</span>,</span>
<span>                     zaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'spatial inconsistency'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2878f8dd59ecdbe0bab4" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-2878f8dd59ecdbe0bab4">{"x":{"visdat":{"b08245d20c1":["function () ","plotlyVisDat"]},"cur_data":"b08245d20c1","attrs":{"b08245d20c1":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true},"b08245d20c1.1":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"mesh3d","opacity":0.5,"facecolor":"grey","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"silhouette"},"yaxis":{"title":"explained inertia"},"zaxis":{"title":"spatial inconsistency"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.2201,0.3886,0.3538,0.328,0.2201,0.2095,0.3207,0.2479,0.3605,0.2434,0.3147,0.2264,0.3173,0.2505,0.3072,0.3211,0.3744,0.3876,0.2529,0.2614,0.2229,0.2764,0.2134,0.2407,0.2157,0.3185,0.2566,0.2595,0.3097,0.2964,0.2571,0.222,0.2649,0.306,0.2801,0.3324,0.323,0.2357,0.3368,0.2379,0.2858,0.3792,0.3472,0.2369,0.3243,0.3733,0.269,0.2254,0.2117,0.3504,0.2449,0.2692,0.3014,0.2906,0.3116,0.2676,0.2662,0.3758,0.3582,0.2929,0.2704,0.2873,0.2989,0.3464,0.3567,0.334,0.2309,0.2329,0.2339,0.2836,0.3573,0.2817,0.364,0.3294,0.3586,0.3255,0.2461,0.3592,0.3826,0.3394,0.2625,0.2823,0.3081,0.37,0.3561,0.2807,0.3642,0.3383,0.3138,0.3106,0.2241,0.3673,0.369,0.2152,0.2258,0.3818,0.3492,0.3594,0.3166,0.3202,0.3305,0.2229,0.2982,0.3031,0.2199,0.2273,0.3359,0.3618,0.2727,0.2895,0.2886,0.2628,0.2994,0.3419,0.3413,0.2836,0.2218,0.3659,0.3765,0.3448,0.2256,0.3513,0.3009,0.3706,0.3251,0.3666,0.355,0.3771,0.2403,0.3158,0.2699,0.3049,0.3547,0.368,0.3329,0.3426,0.2541,0.3677,0.3,0.2931,0.3378,0.3022,0.3269,0.3394,0.3845,0.3653,0.2719,0.3582,0.3029,0.3281,0.3486,0.3044,0.3412,0.3781,0.2271,0.2296,0.3714,0.2782,0.33,0.3134,0.3042,0.3405,0.3043,0.2302,0.2748,0.2959,0.2618,0.2995,0.3276,0.3186,0.3172,0.2266,0.3863,0.3652,0.3248,0.2184,0.2887,0.2737,0.3365,0.3159,0.3064,0.3646,0.3315,0.3361,0.2945,0.3222,0.2949,0.3577,0.3443,0.2973,0.2209,0.3454,0.3779,0.326,0.3703,0.2276,0.2236,0.3401,0.3262,0.2284],"y":[0.4564,0.111,0.0833,0.0889,0.4564,0.4427,0.4519,0.4206,0.3307,0.4265,0.4151,0.4515,0.4524,0.4251,0.2642,0.4498,0.1845,0.1058,0.4146,0.4134,0.456,0.3526,0.4469,0.431,0.4448,0.4178,0.4279,0.4121,0.232,0.3468,0.4296,0.439,0.4227,0.3487,0.3838,0.4084,0.4002,0.4326,0.2054,0.4262,0.3427,0.1768,0.389,0.4303,0.4236,0.1894,0.3554,0.4491,0.4433,0.358,0.4254,0.4178,0.2853,0.3326,0.2496,0.3585,0.3599,0.1486,0.3048,0.3689,0.4001,0.3373,0.3813,0.2139,0.2824,0.4366,0.4347,0.4395,0.4303,0.4096,0.2421,0.3962,0.2987,0.0934,0.3025,0.0981,0.4274,0.3082,0.1149,0.3669,0.4104,0.3954,0.4027,0.2095,0.1717,0.3682,0.2883,0.3544,0.2261,0.2525,0.4404,0.2392,0.2814,0.4474,0.4546,0.1279,0.3143,0.1291,0.4013,0.3357,0.1591,0.456,0.3913,0.387,0.4452,0.4387,0.3602,0.2143,0.3786,0.3342,0.3731,0.4116,0.3642,0.3802,0.1624,0.3439,0.45,0.2685,0.2207,0.0954,0.4547,0.3276,0.3769,0.1664,0.1646,0.1943,0.2982,0.1723,0.4299,0.4043,0.415,0.4028,0.2211,0.2758,0.2583,0.3242,0.4297,0.2344,0.3857,0.3198,0.2366,0.3933,0.1104,0.2169,0.1034,0.2712,0.4205,0.1421,0.2794,0.4393,0.1354,0.4059,0.3281,0.085,0.4512,0.441,0.1328,0.3912,0.0881,0.2273,0.274,0.3095,0.3747,0.4351,0.3535,0.3247,0.4249,0.2551,0.4336,0.2105,0.4523,0.4516,0.092,0.2922,0.1232,0.4465,0.339,0.3441,0.2168,0.2956,0.3328,0.2016,0.4409,0.1371,0.3377,0.4276,0.3654,0.2776,0.1782,0.3164,0.4401,0.2773,0.1722,0.1008,0.2466,0.4415,0.4496,0.2688,0.4309,0.4368],"z":[285.5065,33.5887,17.0562,14.1081,285.5065,212.9317,269.5123,151.651,134.6386,166.1768,155.6955,253.4004,279.8556,163.3636,46.2726,260.2345,51.342,32.5279,145.491,142.3345,276.4678,78.5503,231.4117,182.8974,221.3908,158.2446,175.7823,140.2102,38.766,76.3737,182.804,198.9914,163.9042,78.7248,102.9125,145.2142,127.3039,185.5639,34.1907,163.9841,69.3782,61.3381,161.1999,174.8271,170.1754,52.7661,78.0561,241.4751,215.2024,132.5181,162.7547,152.7106,51.2725,66.3761,42.4227,80.2945,83.0215,40.4982,104.8212,89.2931,124.0927,67.0387,101.9115,45.2125,81.4566,196.1385,188.3629,209.8751,177.0608,147.7227,72.7623,117.3625,108.258,14.5156,103.8851,15.2391,168.9893,110.5621,30.3981,124.8907,136.2251,118.2613,129.1776,64.2287,37.0376,86.2543,106.5484,97.3678,37.655,43.0408,205.4924,74.0077,108.6919,233.5578,265.4376,34.4114,100.0881,28.039,128.3511,75.6399,25.6027,276.4678,114.9609,112.5012,224.2965,201.8564,99.4337,53.2865,95.5262,65.5643,91.5525,138.889,88.1875,160.3373,28.4661,69.8232,247.0916,92.2015,74.6885,17.6989,266.298,119.1879,99.4465,40.6167,26.2354,49.0484,96.922,55.8147,174.9351,130.9483,148.4651,130.8843,50.1628,104.0528,47.8552,88.049,180.2739,72.2201,109.244,60.744,45.174,119.4806,17.1141,42.0655,27.2791,93.3504,169.742,29.0409,49.855,206.601,24.3458,138.3337,93.9183,20.6991,251.44,212.476,31.9622,109.7933,14.1375,37.9562,49.0291,84.5067,105.9263,189.1095,78.4677,63.8428,167.8489,44.632,191.1325,34.5658,279.7913,262.6602,25.6883,114.4111,19.2422,228.908,68.1492,72.0054,36.4561,54.7724,71.9991,50.2885,210.4394,21.8584,67.432,180.4868,87.2759,79.7147,29.9347,59.1043,203.0045,67.7702,57.0177,15.6717,89.8101,211.1463,244.6174,58.8552,186.0017,193.4477],"type":"scatter3d","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"space<br />space","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0.2201,0.3886,0.3538,0.328,0.2201,0.2095,0.3207,0.2479,0.3605,0.2434,0.3147,0.2264,0.3173,0.2505,0.3072,0.3211,0.3744,0.3876,0.2529,0.2614,0.2229,0.2764,0.2134,0.2407,0.2157,0.3185,0.2566,0.2595,0.3097,0.2964,0.2571,0.222,0.2649,0.306,0.2801,0.3324,0.323,0.2357,0.3368,0.2379,0.2858,0.3792,0.3472,0.2369,0.3243,0.3733,0.269,0.2254,0.2117,0.3504,0.2449,0.2692,0.3014,0.2906,0.3116,0.2676,0.2662,0.3758,0.3582,0.2929,0.2704,0.2873,0.2989,0.3464,0.3567,0.334,0.2309,0.2329,0.2339,0.2836,0.3573,0.2817,0.364,0.3294,0.3586,0.3255,0.2461,0.3592,0.3826,0.3394,0.2625,0.2823,0.3081,0.37,0.3561,0.2807,0.3642,0.3383,0.3138,0.3106,0.2241,0.3673,0.369,0.2152,0.2258,0.3818,0.3492,0.3594,0.3166,0.3202,0.3305,0.2229,0.2982,0.3031,0.2199,0.2273,0.3359,0.3618,0.2727,0.2895,0.2886,0.2628,0.2994,0.3419,0.3413,0.2836,0.2218,0.3659,0.3765,0.3448,0.2256,0.3513,0.3009,0.3706,0.3251,0.3666,0.355,0.3771,0.2403,0.3158,0.2699,0.3049,0.3547,0.368,0.3329,0.3426,0.2541,0.3677,0.3,0.2931,0.3378,0.3022,0.3269,0.3394,0.3845,0.3653,0.2719,0.3582,0.3029,0.3281,0.3486,0.3044,0.3412,0.3781,0.2271,0.2296,0.3714,0.2782,0.33,0.3134,0.3042,0.3405,0.3043,0.2302,0.2748,0.2959,0.2618,0.2995,0.3276,0.3186,0.3172,0.2266,0.3863,0.3652,0.3248,0.2184,0.2887,0.2737,0.3365,0.3159,0.3064,0.3646,0.3315,0.3361,0.2945,0.3222,0.2949,0.3577,0.3443,0.2973,0.2209,0.3454,0.3779,0.326,0.3703,0.2276,0.2236,0.3401,0.3262,0.2284],"y":[0.4564,0.111,0.0833,0.0889,0.4564,0.4427,0.4519,0.4206,0.3307,0.4265,0.4151,0.4515,0.4524,0.4251,0.2642,0.4498,0.1845,0.1058,0.4146,0.4134,0.456,0.3526,0.4469,0.431,0.4448,0.4178,0.4279,0.4121,0.232,0.3468,0.4296,0.439,0.4227,0.3487,0.3838,0.4084,0.4002,0.4326,0.2054,0.4262,0.3427,0.1768,0.389,0.4303,0.4236,0.1894,0.3554,0.4491,0.4433,0.358,0.4254,0.4178,0.2853,0.3326,0.2496,0.3585,0.3599,0.1486,0.3048,0.3689,0.4001,0.3373,0.3813,0.2139,0.2824,0.4366,0.4347,0.4395,0.4303,0.4096,0.2421,0.3962,0.2987,0.0934,0.3025,0.0981,0.4274,0.3082,0.1149,0.3669,0.4104,0.3954,0.4027,0.2095,0.1717,0.3682,0.2883,0.3544,0.2261,0.2525,0.4404,0.2392,0.2814,0.4474,0.4546,0.1279,0.3143,0.1291,0.4013,0.3357,0.1591,0.456,0.3913,0.387,0.4452,0.4387,0.3602,0.2143,0.3786,0.3342,0.3731,0.4116,0.3642,0.3802,0.1624,0.3439,0.45,0.2685,0.2207,0.0954,0.4547,0.3276,0.3769,0.1664,0.1646,0.1943,0.2982,0.1723,0.4299,0.4043,0.415,0.4028,0.2211,0.2758,0.2583,0.3242,0.4297,0.2344,0.3857,0.3198,0.2366,0.3933,0.1104,0.2169,0.1034,0.2712,0.4205,0.1421,0.2794,0.4393,0.1354,0.4059,0.3281,0.085,0.4512,0.441,0.1328,0.3912,0.0881,0.2273,0.274,0.3095,0.3747,0.4351,0.3535,0.3247,0.4249,0.2551,0.4336,0.2105,0.4523,0.4516,0.092,0.2922,0.1232,0.4465,0.339,0.3441,0.2168,0.2956,0.3328,0.2016,0.4409,0.1371,0.3377,0.4276,0.3654,0.2776,0.1782,0.3164,0.4401,0.2773,0.1722,0.1008,0.2466,0.4415,0.4496,0.2688,0.4309,0.4368],"z":[285.5065,33.5887,17.0562,14.1081,285.5065,212.9317,269.5123,151.651,134.6386,166.1768,155.6955,253.4004,279.8556,163.3636,46.2726,260.2345,51.342,32.5279,145.491,142.3345,276.4678,78.5503,231.4117,182.8974,221.3908,158.2446,175.7823,140.2102,38.766,76.3737,182.804,198.9914,163.9042,78.7248,102.9125,145.2142,127.3039,185.5639,34.1907,163.9841,69.3782,61.3381,161.1999,174.8271,170.1754,52.7661,78.0561,241.4751,215.2024,132.5181,162.7547,152.7106,51.2725,66.3761,42.4227,80.2945,83.0215,40.4982,104.8212,89.2931,124.0927,67.0387,101.9115,45.2125,81.4566,196.1385,188.3629,209.8751,177.0608,147.7227,72.7623,117.3625,108.258,14.5156,103.8851,15.2391,168.9893,110.5621,30.3981,124.8907,136.2251,118.2613,129.1776,64.2287,37.0376,86.2543,106.5484,97.3678,37.655,43.0408,205.4924,74.0077,108.6919,233.5578,265.4376,34.4114,100.0881,28.039,128.3511,75.6399,25.6027,276.4678,114.9609,112.5012,224.2965,201.8564,99.4337,53.2865,95.5262,65.5643,91.5525,138.889,88.1875,160.3373,28.4661,69.8232,247.0916,92.2015,74.6885,17.6989,266.298,119.1879,99.4465,40.6167,26.2354,49.0484,96.922,55.8147,174.9351,130.9483,148.4651,130.8843,50.1628,104.0528,47.8552,88.049,180.2739,72.2201,109.244,60.744,45.174,119.4806,17.1141,42.0655,27.2791,93.3504,169.742,29.0409,49.855,206.601,24.3458,138.3337,93.9183,20.6991,251.44,212.476,31.9622,109.7933,14.1375,37.9562,49.0291,84.5067,105.9263,189.1095,78.4677,63.8428,167.8489,44.632,191.1325,34.5658,279.7913,262.6602,25.6883,114.4111,19.2422,228.908,68.1492,72.0054,36.4561,54.7724,71.9991,50.2885,210.4394,21.8584,67.432,180.4868,87.2759,79.7147,29.9347,59.1043,203.0045,67.7702,57.0177,15.6717,89.8101,211.1463,244.6174,58.8552,186.0017,193.4477],"type":"mesh3d","opacity":0.5,"facecolor":["grey"],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To select a solution, we will limit our choices to the results with a
silhouette index above 0.34 and an explained above 0.30.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solutions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">df_tot</span>,</span>
<span>                      <span class="va">df_tot</span><span class="op">$</span><span class="va">silhouette</span> <span class="op">&gt;=</span> <span class="fl">0.34</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">df_tot</span><span class="op">$</span><span class="va">inertia</span> <span class="op">&gt;=</span> <span class="fl">0.30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">solutions</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">m</th>
<th align="right">alpha</th>
<th align="right">beta</th>
<th align="right">silhouette</th>
<th align="right">space</th>
<th align="right">inertia</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">9</td>
<td align="right">1.47</td>
<td align="right">0.01</td>
<td align="right">0.14</td>
<td align="right">0.36</td>
<td align="right">134.64</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="left">43</td>
<td align="right">1.33</td>
<td align="right">0.05</td>
<td align="right">0.07</td>
<td align="right">0.35</td>
<td align="right">161.20</td>
<td align="right">0.39</td>
</tr>
<tr class="odd">
<td align="left">50</td>
<td align="right">1.44</td>
<td align="right">0.10</td>
<td align="right">0.25</td>
<td align="right">0.35</td>
<td align="right">132.52</td>
<td align="right">0.36</td>
</tr>
<tr class="even">
<td align="left">59</td>
<td align="right">1.51</td>
<td align="right">0.11</td>
<td align="right">0.13</td>
<td align="right">0.36</td>
<td align="right">104.82</td>
<td align="right">0.30</td>
</tr>
<tr class="odd">
<td align="left">75</td>
<td align="right">1.52</td>
<td align="right">0.11</td>
<td align="right">0.14</td>
<td align="right">0.36</td>
<td align="right">103.89</td>
<td align="right">0.30</td>
</tr>
<tr class="even">
<td align="left">78</td>
<td align="right">1.53</td>
<td align="right">0.08</td>
<td align="right">0.22</td>
<td align="right">0.36</td>
<td align="right">110.56</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="left">97</td>
<td align="right">1.52</td>
<td align="right">0.19</td>
<td align="right">0.27</td>
<td align="right">0.35</td>
<td align="right">100.09</td>
<td align="right">0.31</td>
</tr>
<tr class="even">
<td align="left">114</td>
<td align="right">1.34</td>
<td align="right">0.02</td>
<td align="right">0.05</td>
<td align="right">0.34</td>
<td align="right">160.34</td>
<td align="right">0.38</td>
</tr>
<tr class="odd">
<td align="left">122</td>
<td align="right">1.48</td>
<td align="right">0.09</td>
<td align="right">0.19</td>
<td align="right">0.35</td>
<td align="right">119.19</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="left">136</td>
<td align="right">1.50</td>
<td align="right">0.37</td>
<td align="right">0.33</td>
<td align="right">0.34</td>
<td align="right">88.05</td>
<td align="right">0.32</td>
</tr>
<tr class="odd">
<td align="left">153</td>
<td align="right">1.54</td>
<td align="right">0.30</td>
<td align="right">0.47</td>
<td align="right">0.34</td>
<td align="right">93.92</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="left">162</td>
<td align="right">1.69</td>
<td align="right">0.30</td>
<td align="right">0.68</td>
<td align="right">0.34</td>
<td align="right">84.51</td>
<td align="right">0.31</td>
</tr>
</tbody>
</table>
<p>We will select the one of the obtained solutions we found here. It
has the rank 153 in the final set of solutions. We also compare it with
the solution we selected with a grid search approach in the vignette
<code>introduction</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">version1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/SGFCMeans.html">SGFCMeans</a></span><span class="op">(</span><span class="va">Data</span>,<span class="va">WMat</span> ,k <span class="op">=</span> <span class="fl">4</span>,m<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.95</span>, beta <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>                    standardize <span class="op">=</span> <span class="cn">TRUE</span>, robust <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    verbose <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>                    tol<span class="op">=</span><span class="fl">0.0001</span>, init <span class="op">=</span> <span class="st">"kpp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">solutions</span><span class="op">[</span><span class="fl">11</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">version2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/SGFCMeans.html">SGFCMeans</a></span><span class="op">(</span><span class="va">Data</span>,<span class="va">WMat</span> ,k <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    m <span class="op">=</span> <span class="va">parameters</span><span class="op">$</span><span class="va">m</span>,</span>
<span>                    alpha<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">alpha</span>,</span>
<span>                    beta <span class="op">=</span> <span class="va">parameters</span><span class="op">$</span><span class="va">beta</span>,</span>
<span>                    standardize <span class="op">=</span> <span class="cn">TRUE</span>, robust <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    verbose <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>                    tol<span class="op">=</span><span class="fl">0.0001</span>, init <span class="op">=</span> <span class="st">"kpp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculating the indexes for the clustering</span></span>
<span><span class="va">idx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcqualityIndexes.html">calcqualityIndexes</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">version1</span><span class="op">$</span><span class="va">Data</span>,</span>
<span>                           belongmatrix <span class="op">=</span> <span class="va">version1</span><span class="op">$</span><span class="va">Belongings</span>,</span>
<span>                           m <span class="op">=</span> <span class="va">version1</span><span class="op">$</span><span class="va">m</span>,</span>
<span>                           indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Silhouette.index"</span>,</span>
<span>                           <span class="st">"XieBeni.index"</span>, <span class="st">"FukuyamaSugeno.index"</span>,</span>
<span>                           <span class="st">"Explained.inertia"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">idx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcqualityIndexes.html">calcqualityIndexes</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">version2</span><span class="op">$</span><span class="va">Data</span>,</span>
<span>                           belongmatrix <span class="op">=</span> <span class="va">version2</span><span class="op">$</span><span class="va">Belongings</span>,</span>
<span>                           m <span class="op">=</span> <span class="va">version2</span><span class="op">$</span><span class="va">m</span>,</span>
<span>                           indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Silhouette.index"</span>,</span>
<span>                           <span class="st">"XieBeni.index"</span>, <span class="st">"FukuyamaSugeno.index"</span>,</span>
<span>                           <span class="st">"Explained.inertia"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculating the spatial indexes</span></span>
<span><span class="va">space1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/spatialDiag.html">spatialDiag</a></span><span class="op">(</span><span class="va">version1</span>,nrep <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">space2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/spatialDiag.html">spatialDiag</a></span><span class="op">(</span><span class="va">version2</span>,nrep <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="va">idx1</span><span class="op">$</span><span class="va">spatial.Consistency</span> <span class="op">&lt;-</span> <span class="va">space1</span><span class="op">$</span><span class="va">SpConsist</span></span>
<span><span class="va">idx2</span><span class="op">$</span><span class="va">spatial.Consistency</span> <span class="op">&lt;-</span> <span class="va">space2</span><span class="op">$</span><span class="va">SpConsist</span></span>
<span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>,<span class="va">idx1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>,<span class="va">idx2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"reference"</span>,<span class="st">"optimized"</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span>
<span><span class="va">tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">scores</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">scores</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">tests</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">scores</span><span class="op">$</span><span class="va">better</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">test1</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">reference</th>
<th align="right">optimized</th>
<th align="left">better</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Silhouette.index</td>
<td align="right">0.2980</td>
<td align="right">0.3403</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">XieBeni.index</td>
<td align="right">2.0611</td>
<td align="right">1.8835</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">FukuyamaSugeno.index</td>
<td align="right">1976.3404</td>
<td align="right">1646.7294</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Explained.inertia</td>
<td align="right">0.3292</td>
<td align="right">0.3281</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">spatial.Consistency</td>
<td align="right">0.1502</td>
<td align="right">0.2241</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>The optimized version gives a slightly lower spatial consistency, but
also a significantly higher silhouette index.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeremy Gelb.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
