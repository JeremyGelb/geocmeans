<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced examples • geocmeans</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Advanced examples">
<meta property="og:description" content="geocmeans">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">geocmeans</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/adjustinconsistency.html">An adjusted spatial inconsistency index</a>
    </li>
    <li>
      <a href="../../articles/FCMres.html">Creating a FCMres object</a>
    </li>
    <li>
      <a href="../../articles/introduction.html">Spatial Fuzzy CMean with R</a>
    </li>
    <li>
      <a href="../../articles/rasters.html">Fuzzy clustering with rasters</a>
    </li>
    <li>
      <a href="../../articles/web_vignettes/advanced_examples.html">Advanced examples</a>
    </li>
    <li>
      <a href="../../articles/web_vignettes/optimizing_parameters.html">Optimizing Parameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JeremyGelb/geocmeans/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced examples</h1>
                        <h4 data-toc-skip class="author">Jeremy Gelb</h4>
            
            <h4 data-toc-skip class="date">14/12/2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JeremyGelb/geocmeans/blob/HEAD/vignettes/web_vignettes/advanced_examples.Rmd" class="external-link"><code>vignettes/web_vignettes/advanced_examples.Rmd</code></a></small>
      <div class="hidden name"><code>advanced_examples.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This vignette gives some advanced examples with the package <code>geocmeans</code>. It is recommended to read the vignette <code>introduction</code> first.</p>
</div>
<div class="section level3">
<h3 id="sfcm-with-spatial-non-local-information">SFCM with spatial non-local information<a class="anchor" aria-label="anchor" href="#sfcm-with-spatial-non-local-information"></a>
</h3>
<p>It has been proposed to modify the SFCM algorithm to include “non-local spatial information” instead of the information provided by close observations <span class="citation">(<a href="#ref-zhao2015multiobjective" role="doc-biblioref">Zhao, Liu, and Fan 2015</a>)</span>. Basically, this implies a modified spatial weighting scheme combining neighbouring and semantic distance. This way, more similar neighbours get more weights in the calculation of the lagged dataset which can be desirable in dataset characterized by a lot of noise. When working with a classical vector dataset, one can use the function <code>adjustSpatialWeights</code> and create a row-standardized weight matrix using the inverse of the euclidean distance between observation and their neighbours as weights.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JeremyGelb/geocmeans" class="external-link">geocmeans</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap" class="external-link">tmap</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AnalysisFields</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lden"</span>,<span class="st">"NO2"</span>,<span class="st">"PM25"</span>,<span class="st">"VegHautPrt"</span>,<span class="st">"Pct0_14"</span>,</span>
<span>                   <span class="st">"Pct_65"</span>,<span class="st">"Pct_Img"</span>,<span class="st">"TxChom1564"</span>,<span class="st">"Pct_brevet"</span>,<span class="st">"NivVieMed"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">LyonIris</span><span class="op">[</span><span class="va">AnalysisFields</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the spatial weight matrix</span></span>
<span><span class="va">Neighbours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html" class="external-link">poly2nb</a></span><span class="op">(</span><span class="va">LyonIris</span>,queen <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">WMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">Neighbours</span>,style<span class="op">=</span><span class="st">"W"</span>,zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the modified weight matrix</span></span>
<span><span class="va">WMat_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/adjustSpatialWeights.html">adjustSpatialWeights</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">WMat</span><span class="op">$</span><span class="va">neighbours</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the modified version of FCM with non-local information</span></span>
<span><span class="va">nl_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/SFCMeans.html">SFCMeans</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">WMat_adj</span>, k <span class="op">=</span> <span class="fl">4</span>, m <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                 tol <span class="op">=</span> <span class="fl">0.0001</span>, standardize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">456</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># comparing with the standard SFCM</span></span>
<span><span class="va">SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/SFCMeans.html">SFCMeans</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">WMat</span>, k <span class="op">=</span> <span class="fl">4</span>, m <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                 tol <span class="op">=</span> <span class="fl">0.0001</span>, standardize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">456</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># spatial consistency</span></span>
<span><span class="va">consis_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/spConsistency.html">spConsistency</a></span><span class="op">(</span><span class="va">SFCM</span>, <span class="va">WMat</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">consis_nl_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/spConsistency.html">spConsistency</a></span><span class="op">(</span><span class="va">nl_SFCM</span>, <span class="va">WMat</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># silhouette index</span></span>
<span><span class="va">silh_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcSilhouetteIdx.html">calcSilhouetteIdx</a></span><span class="op">(</span><span class="va">SFCM</span><span class="op">$</span><span class="va">Data</span>, <span class="va">SFCM</span><span class="op">$</span><span class="va">Belongings</span><span class="op">)</span></span>
<span><span class="va">silh_nl_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcSilhouetteIdx.html">calcSilhouetteIdx</a></span><span class="op">(</span><span class="va">nl_SFCM</span><span class="op">$</span><span class="va">Data</span>, <span class="va">nl_SFCM</span><span class="op">$</span><span class="va">Belongings</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># explained inertia</span></span>
<span><span class="va">inert_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcexplainedInertia.html">calcexplainedInertia</a></span><span class="op">(</span><span class="va">SFCM</span><span class="op">$</span><span class="va">Data</span>, <span class="va">SFCM</span><span class="op">$</span><span class="va">Belongings</span><span class="op">)</span></span>
<span><span class="va">inert_nl_SFCM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calcexplainedInertia.html">calcexplainedInertia</a></span><span class="op">(</span><span class="va">nl_SFCM</span><span class="op">$</span><span class="va">Data</span>, <span class="va">nl_SFCM</span><span class="op">$</span><span class="va">Belongings</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SFCM"</span>, <span class="st">"nlSFCM"</span><span class="op">)</span>,</span>
<span>  silhouette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">silh_SFCM</span>, <span class="va">silh_nl_SFCM</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>  spatial_cons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">consis_SFCM</span><span class="op">$</span><span class="va">Median</span>, <span class="va">consis_nl_SFCM</span><span class="op">$</span><span class="va">Median</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>  inertia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">inert_SFCM</span>, <span class="va">inert_nl_SFCM</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">algorithm</th>
<th align="right">silhouette</th>
<th align="right">spatial_cons</th>
<th align="right">inertia</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SFCM</td>
<td align="right">0.650</td>
<td align="right">0.412</td>
<td align="right">0.787</td>
</tr>
<tr class="even">
<td align="left">nlSFCM</td>
<td align="right">0.326</td>
<td align="right">0.336</td>
<td align="right">0.564</td>
</tr>
</tbody>
</table>
<p>We can see here that the SFCM with non-local information yield results with a better spatial consistency, a better silhouette index but a lower explained inertia.</p>
</div>
<div class="section level3">
<h3 id="robust-fcm">Robust FCM<a class="anchor" aria-label="anchor" href="#robust-fcm"></a>
</h3>
<p>It is possible to obtain a “robust” version of the FCM algorithm by normalizing the calculated distances between the centres of the groups and the observations by the spread of the centres <span class="citation">(<a href="#ref-tsai2011fuzzy" role="doc-biblioref">Tsai and Lin 2011</a>)</span>. With this modification, the algorithm can find clusters with different densities.</p>
<p>We illustrate this with a simple example, let us consider the following dataset with two clusters.</p>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-2-1.png" width="90%"></p>
<p>The first cluster is a sphere and the second is spread along the Y axis. If we use the classical FCM algorthim , we end up with the following fuzzy partition.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># preparing the functions to scale and unscale the data</span></span>
<span><span class="va">data_scales</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/standardizer.html">standardizer</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># classical fuzzy cmeans</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/CMeans.html">CMeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span>, robust <span class="op">=</span> <span class="cn">FALSE</span>,  verbose <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">176</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotting the membership matrix</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span>  <span class="va">df2</span><span class="op">$</span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="va">result1</span><span class="op">$</span><span class="va">Belongings</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">Centers</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span></span>
<span>  <span class="va">df3</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data_scales</span><span class="op">$</span><span class="va">X</span><span class="op">$</span><span class="fu">unscale</span><span class="op">(</span><span class="va">df3</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="va">df3</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data_scales</span><span class="op">$</span><span class="va">Y</span><span class="op">$</span><span class="fu">unscale</span><span class="op">(</span><span class="va">df3</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span>  <span class="va">myplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, color <span class="op">=</span> <span class="va">proba</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df3</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"group "</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">myplot</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plots</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-3-1.png" width="90%"></p>
<p>One can see that several points are not attributed to the right cluster on the left of the picture. This is because they are closer to the first cluster. This can be corrected if we normalize the distances to the two clusters (robust FCM).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># robust fuzzy cmeans</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/CMeans.html">CMeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span>, robust <span class="op">=</span> <span class="cn">TRUE</span>,  verbose <span class="op">=</span> <span class="cn">FALSE</span>, seed <span class="op">=</span> <span class="fl">176</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotting the membership matrix</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span>  <span class="va">df2</span><span class="op">$</span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="va">result2</span><span class="op">$</span><span class="va">Belongings</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result2</span><span class="op">$</span><span class="va">Centers</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span></span>
<span>  <span class="va">df3</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">data_scales</span><span class="op">$</span><span class="va">X</span><span class="op">$</span><span class="fu">unscale</span><span class="op">(</span><span class="va">df3</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="va">df3</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">data_scales</span><span class="op">$</span><span class="va">Y</span><span class="op">$</span><span class="fu">unscale</span><span class="op">(</span><span class="va">df3</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span>  <span class="va">myplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, color <span class="op">=</span> <span class="va">proba</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df3</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"group "</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">myplot</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plots</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-4-1.png" width="90%"></p>
<p>The normalization is available for FCM, SFCM, GFCM and SFGCM. when applied to SFCM or SGFCM, the normalization is applied separately for the spatial and the non spatial data.</p>
</div>
<div class="section level3">
<h3 id="fcm-with-noise-cluster">FCM with noise cluster<a class="anchor" aria-label="anchor" href="#fcm-with-noise-cluster"></a>
</h3>
<p>FCM algorithm can be sensitive to noise. Outliers and noise points will affect the centre of the clusters and the final membership matrix. One method to limit their effects is too add a noise cluster to the method. Each observation is at the same distance to this cluster. This distance must be set by the user and is written <span class="math inline">\(\delta\)</span>. Several distances could be used to check the quality of the clustering. We just illustrate here how the parameter works. Let us consider the same dataset, but with more noise.</p>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-5-1.png" width="90%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/CMeans.html">CMeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  noise_cluster <span class="op">=</span> <span class="cn">TRUE</span>, delta <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                  seed <span class="op">=</span> <span class="fl">176</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="va">result3</span><span class="op">$</span><span class="va">noise_cluster</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, color <span class="op">=</span> <span class="va">proba</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"noise cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-6-1.png" width="90%"> We can see here that delta is too low because most of the points belong to the noise cluster. We will incrase the value of delta.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/CMeans.html">CMeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  noise_cluster <span class="op">=</span> <span class="cn">TRUE</span>, delta <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                  seed <span class="op">=</span> <span class="fl">176</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="va">result3</span><span class="op">$</span><span class="va">noise_cluster</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, color <span class="op">=</span> <span class="va">proba</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"noise cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-7-1.png" width="90%"></p>
<p>Here delta is likely to small, even the points at the edge of the dataset have a weak membership value to the noise cluster.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/CMeans.html">CMeans</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  robust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  noise_cluster <span class="op">=</span> <span class="cn">TRUE</span>, delta <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  seed <span class="op">=</span> <span class="fl">176</span><span class="op">)</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="va">result3</span><span class="op">$</span><span class="va">Belongings</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">U</span>,<span class="va">result3</span><span class="op">$</span><span class="va">noise_cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">df2</span><span class="op">$</span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="va">result3</span><span class="op">$</span><span class="va">noise_cluster</span></span>
<span></span>
<span><span class="co"># plotting the membership matrix</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span>  <span class="va">df2</span><span class="op">$</span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="va">U</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">myplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">Y</span>, color <span class="op">=</span> <span class="va">proba</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"group "</span>,<span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">myplot</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plots</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>          common.legend <span class="op">=</span> <span class="cn">TRUE</span>, legend<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced_examples_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>Here delta gives a better results and the noise points are well identified.</p>
<p>Note that the noise cluster does not have a centre. It should not be considered as a well defined cluster, but as a group of outliers.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-tsai2011fuzzy" class="csl-entry">
Tsai, Du-Ming, and Chung-Chan Lin. 2011. <span>“Fuzzy c-Means Based Clustering for Linearly and Nonlinearly Separable Data.”</span> <em>Pattern Recognition</em> 44 (8): 1750–60.
</div>
<div id="ref-zhao2015multiobjective" class="csl-entry">
Zhao, Feng, Hanqiang Liu, and Jiulun Fan. 2015. <span>“A Multiobjective Spatial Fuzzy Clustering Algorithm for Image Segmentation.”</span> <em>Applied Soft Computing</em> 30: 48–57.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeremy Gelb.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
